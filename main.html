<!DOCTYPE html>
<html>

<head>

  <title> test </title>
  <meta charset="utf-8">
  <link rel="stylesheet" href="/src/mystyle.css">
</head>

<body>
  <div id="header-wrapper">

  </div>
  <div id="workspace">
    <div class="panel-left">

    </div>
    <div class="panel-right">

    </div>
    <div class="panel-center">
      <div class="tabs" id="tabs_code"> </div>
    </div>
    <div class="panel-bottom">

    </div>
  </div>
  <script>

    class Tab{
      element;
      ul;
      contents;
      previous = 0;
      count = 0;
      constructor(id){
        this.element = document.getElementById(id);
        var ul = document.createElement('ul');
        var div = document.createElement('div');
        div.classList.add('tab-content');
        this.element.appendChild(ul);
        this.element.appendChild(div);

        this.ul = this.element.querySelector('ul');
        this.contents = this.element.querySelector('div');
      }
      focus(index) {
        if (this.count > 0) {
          var li = this.ul.querySelectorAll('li');
          var con = this.contents.querySelectorAll('div');
          if (this.previous > 0) {
            li[this.previous - 1].classList.remove('tab_current');
            con[this.previous - 1].style.display = 'none';
          }

          li[index - 1].classList.add('tab_current');
          con[index - 1].style.display = 'block';
          this.previous = index;
        }
      }
      
      update(){
        var li = this.ul.querySelectorAll('li');
        var con = this.contents.querySelectorAll('div');
        for(var i = 0 ; i < li.length; i++)
        {
          li[i].id = i+1;
        }
      }
      closeTab(index){
        this.count--;
        var li = this.ul.querySelectorAll('li');
        li[index-1].remove();
        this.update();
        if(this.previous === index)
        {
          this.focus(index);
        }
      }

      addTab(name){
        this.count++;
        var tab = document.createElement('li')
        tab.classList.add('tab');
        tab.id = this.count;
        tab.innerHTML = name;
        tab.addEventListener('click', (event)=> {
          if(event.target.id != "")
          {
            this.focus(event.target.id);
          }
        });
        var tab_close = document.createElement('div');
        tab_close.classList.add('tab_close');
        tab_close.innerHTML = 'X';
        tab_close.addEventListener('click', (event)=> {
          this.closeTab(event.target.parentElement.id);
        });
        tab.appendChild(tab_close);
        this.ul.appendChild(tab);

        var content = document.createElement('div')
        content.classList.add('tab_content');
        content.id = this.count;
        content.innerHTML = name;
        this.contents.appendChild(content);

        this.focus(this.count);
      }
    }
  
    const tabs_code = new Tab('tabs_code');
    tabs_code.addTab('first');
    tabs_code.addTab('second'); 
    tabs_code.addTab('third'); 
  </script>
</body>

</html>